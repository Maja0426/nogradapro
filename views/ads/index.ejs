<% include ../partials/header %>

<div class="jumbotron index">
  <h1 class="d-none d-md-block display-3">Nógrád Apró</h1>
  <h3>Ingyenes apróhirdetés, Nógrád megyére szabva.</h3>
  <p class="lead">Hirdess ingyen, kötelezettségek nélkül.</p>
  <hr class="my-3">
  <p>Keresel, vagy kínálsz? Villámgyors, ingyenes hirdetésfeladás. Itt találkozik a kereslet a kínálattal.</p>

  <p class="lead">
    <a class="btn btn-primary btn-lg" href="/help" role="button"><i class="fas fa-info-circle"></i> Segítség</a>
  </p>
</div>
<div class="container-fluid main-content">

  

  <div class="row">

    <% ads.reverse().forEach(function(ad) { %>
    <div class="col-xl-3 col-lg-4 col-sm-6">
      <div class="card ads-card mb-3">
        <div class="card-body p-2 <%= ad.mainCategory === 'Keres' ? 'bg-dark text-light' : 'bg-primary text-light' %>">
          <h5 class="card-title font-weight-bold bg-light text-dark text-center p-2">
            <%= ad.title.length > 22 ? ad.title.substring(0,22)+'...' : ad.title %>
          </h5>
          <img src="<%= ad.image === '' ? 'https://res.cloudinary.com/maja0426/image/upload/v1550587836/Aprohirdetes/NoImageFound.png' : ad.image %>"
            class="card-img" alt="User photo">
          <div class="mt-1">
            <span class="badge badge-light">#
              <%= ad.mainCategory %></span>
            <span class="badge badge-light">#
              <%= ad.city %></span>
            <span class="badge badge-light">#
              <%= ad.category %></span>
          </div>
        </div>
        <div class="card-footer bg-secondary">
          <div class="row">
            <div class="col-6">
              <p><i class="fas fa-clock"></i>
                <%= moment(ad.createdAt).format('YYYY.MM.D.') %>
              </p>
              <p><i class="fas fa-money-bill-alt"></i>
                <%= ad.price === '' ? 'Nincs ár' : ad.price %>
              </p>
            </div>
            <div class="col-6">
              <a class="btn btn btn-dark mt-2" href="/ads/<%= ad._id %>">MEGNÉZEM</a>
            </div>
          </div>
        </div>
      </div>
    </div>
    <% }) %>
  </div>




<div class="">
  <% if (pages && pages > 0) { %>
  <ul class="pagination justify-content-center mt-4">
    <% if (current == 1) { %>
    <li class="page-item disabled"><a class="page-link">Első</a></li>
    <% } else { %>
    <li><a class="page-link" href="/ads<%if(search){%>?search=<%=search%><%}%>">Első</a></li>
    <% } %>

    <% if (current == 1) { %>
    <li class="page-item disabled"><a class="page-link">«</a></li>
    <% } else { %>
    <li><a class="page-link" href="/ads?page= <%=Number(current) - 1 %>
    <%if(search){%>&search=
    <%=search%>
    <%}%>">«</a></li>
    <% } %>

    <% var i = (Number(current) > 5 ? Number(current) - 4 : 1) %>
    <% if (i !== 1) { %>
    <li class="page-item disabled"><a class="page-link">...</a></li>
    <% } %>
    <% for (; i <= (Number(current) + 4) && i <= pages; i++) { %>
    <% if (i == current) { %>
    <li class="active"><a class="page-link">
        <%= i %></a></li>
    <% } else { %>
    <li><a class="page-link" href="/ads?page=<%= i %><%if(search){%>&search=<%=search%><%}%>">
        <%= i %></a></li>
    <% } %>
    <% if (i == Number(current) + 4 && i < pages) { %>
    <li class="page-item disabled"><a>...</a></li>
    <% } %>
    <% } %>

    <% if (current == pages) { %>
    <li class="page-item disabled"><a class="page-link">»</a></li>
    <% } else { %>
    <li><a class="page-link" href="/ads?page=<%= Number(current) + 1 %><%if(search){%>&search=<%=search%><%}%>">»</a></li>
    <% } %>

    <% if (current == pages) { %>
    <li class="page-item disabled"><a class="page-link">Utolsó</a></li>
    <% } else { %>
    <li><a class="page-link" href="/ads?page=<%= pages %><%if(search){%>&search=<%=search%><%}%>">Utolsó</a></li>
    <% } %>
  </ul>
  <% } %>
</div>

</div>

<% include ../partials/footer %>